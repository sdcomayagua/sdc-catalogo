<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Soluciones Digitales Comayagua | Cat√°logo</title>

  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üëæ</text></svg>">

  <meta property="og:title" content="Soluciones Digitales Comayagua | Cat√°logo Gamer 2026" />
  <meta property="og:description" content="Cat√°logo oficial de accesorios Gamer, PC y Streaming. Env√≠os a toda Honduras. ¬°Equ√≠pate con lo mejor!" />
  <meta property="og:image" content="https://raw.githubusercontent.com/sdcomayagua/sdc-catalogo/main/PORTADA%20-%20SDC%20-%202026.png" />
  <meta property="og:type" content="website" />
  <meta name="theme-color" content="#0b1120" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- Solo 3 pesos para cargar m√°s r√°pido -->
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

  <style>
    :root{
      --bg:#0b1120; --card-bg:#151e32;
      --primary:#38bdf8; --accent:#2dd4bf;
      --text:#f8fafc; --text-muted:#94a3b8;
      --border:#1e293b; --shadow-card:0 4px 6px -1px rgba(0,0,0,.5);
      --chip-bg:#1e293b; --chip-text:#cbd5e1;
      --bg-image:radial-gradient(at top,#1e293b 0%,#0b1120 100%);
      --danger:#ef4444;
      --promo-color:#ff6b00; --promo-glow:rgba(255,107,0,.6); --promo-bg:rgba(255,107,0,.15);
    }
    [data-theme="light"]{
      --bg:#f8fafc; --card-bg:#ffffff;
      --primary:#0f172a; --accent:#15803d;
      --text:#1a1a1a; --text-muted:#64748b;
      --border:#e2e8f0; --shadow-card:0 4px 15px rgba(0,0,0,.05);
      --chip-bg:#ffffff; --chip-text:#4b5563;
      --bg-image:none;
      --promo-color:#ea580c; --promo-glow:rgba(234,88,12,.2); --promo-bg:#fff7ed;
    }

    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    body{
      margin:0; font-family:'Outfit',sans-serif;
      background-color:var(--bg); background-image:var(--bg-image); background-attachment:fixed;
      color:var(--text); padding-bottom:90px; transition:background .25s,color .25s;
      -webkit-user-select:none; user-select:none;
    }

    header{
      position:sticky; top:0; z-index:100;
      background:var(--card-bg); border-bottom:1px solid var(--border);
      padding:12px 16px; display:flex; align-items:center; justify-content:space-between;
      box-shadow:0 4px 20px rgba(0,0,0,.1);
    }
    .brand{display:flex;align-items:center;gap:10px;cursor:pointer}
    .brand img{height:40px;border-radius:6px;pointer-events:none}
    .brand h1{margin:0;font-size:16px;font-weight:900;color:var(--text);text-transform:uppercase;letter-spacing:1px}
    .brand h1 span{color:var(--primary)}
    .icon-row{display:flex;gap:10px;align-items:center}
    .icon-btn{
      background:transparent;border:1px solid var(--border);color:var(--text);
      width:35px;height:35px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;cursor:pointer;
    }

    .hero-section{padding:34px 20px 14px;text-align:center;margin-bottom:6px}
    .hero-title{font-size:28px;font-weight:900;margin:0 0 10px;line-height:1.1;color:var(--text);text-transform:uppercase;letter-spacing:-.5px}
    .hero-highlight{
      background:linear-gradient(-45deg,#38bdf8,#818cf8,#2dd4bf,#38bdf8);
      background-size:300%;
      -webkit-background-clip:text; -webkit-text-fill-color:transparent;
      animation:textShine 6s ease-in-out infinite;
    }
    [data-theme="light"] .hero-highlight{
      background:linear-gradient(-45deg,#0284c7,#4f46e5,#059669,#0284c7);
      background-size:300%;
      -webkit-background-clip:text; -webkit-text-fill-color:transparent;
    }
    @keyframes textShine{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    .hero-desc{font-size:14px;color:var(--text-muted);margin:0 auto;line-height:1.5;max-width:92%;font-weight:400}

    .search-container{padding:0 16px;max-width:820px;margin:16px auto}
    .search-box{position:relative;display:flex;align-items:center}
    .search-box i{position:absolute;left:14px;color:var(--text-muted)}
    .search-box input{
      width:100%;padding:14px 16px 14px 45px;border-radius:16px;
      border:1px solid var(--border);background:var(--card-bg);
      color:var(--text);font-size:15px;outline:none;font-weight:700;
      box-shadow:0 4px 10px rgba(0,0,0,.05);
      user-select:text;-webkit-user-select:text;
    }
    .search-box input:focus{border-color:var(--primary)}

    .trust-grid{
      display:grid;grid-template-columns:repeat(2,1fr);gap:12px;
      padding:0 16px;max-width:820px;margin:18px auto 22px;
    }
    .trust-item{
      display:flex;align-items:center;justify-content:center;gap:8px;
      font-size:11px;font-weight:700;color:var(--text-muted);
      background:var(--card-bg);padding:10px;border-radius:12px;
      border:1px solid var(--border);box-shadow:0 2px 5px rgba(0,0,0,.02);
    }
    .trust-item i{color:var(--accent);font-size:14px}

    .filters-wrapper{
      position:sticky;top:60px;z-index:90;
      background:var(--bg);padding:14px 0 10px;border-bottom:1px solid transparent;transition:.25s;
    }
    .filters-wrapper.scrolled{background:var(--card-bg);border-bottom:1px solid var(--border);box-shadow:0 4px 10px rgba(0,0,0,.1)}
    .category-bar,.sub-bar{
      display:flex;gap:10px;overflow-x:auto;padding:0 16px 8px;scrollbar-width:none;
    }
    .chip{
      padding:8px 18px;border-radius:99px;background:var(--chip-bg);
      border:1px solid var(--border);color:var(--chip-text);
      font-size:13px;font-weight:900;white-space:nowrap;cursor:pointer;
      display:flex;align-items:center;gap:6px;text-transform:uppercase;transition:all .18s;
    }
    .chip.active{background:var(--primary);color:#fff;border-color:var(--primary);box-shadow:0 4px 12px rgba(0,0,0,.2);transform:translateY(-1px)}
    [data-theme="dark"] .chip.active{color:#000}
    .chip.promo-toggle{background:linear-gradient(135deg,#f59e0b,#d97706);border-color:#f59e0b;color:#fff;box-shadow:0 0 18px rgba(245,158,11,.55)}
    .chip.promo-toggle.off{background:var(--chip-bg);border-color:var(--border);color:var(--chip-text);box-shadow:none}

    .sub-bar .chip{padding:6px 14px;font-size:11px;border-radius:10px;background:transparent;border:1px solid var(--border)}
    .sub-bar .chip.active{background:var(--text);border-color:var(--text);color:var(--bg)}

    .info-bar{
      max-width:1200px;margin:10px auto 6px;padding:0 16px;
      display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:center;
    }
    .info-pill{
      font-size:11px;font-weight:900;letter-spacing:.5px;text-transform:uppercase;
      color:var(--text-muted);border:1px solid var(--border);background:rgba(255,255,255,.03);
      padding:7px 12px;border-radius:999px;
    }
    [data-theme="light"] .info-pill{background:#fff}

    .grid{
      display:grid;grid-template-columns:1fr;gap:16px;padding:10px 16px;
      max-width:1200px;margin:0 auto;min-height:200px;
    }
    @media(min-width:768px){.grid{grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:24px}}

    .welcome-state{grid-column:1/-1;text-align:center;padding:40px 20px;color:var(--text-muted)}
    .welcome-icon{font-size:50px;margin-bottom:20px;color:var(--primary);opacity:.8}
    .welcome-title{font-size:18px;font-weight:900;color:var(--text);margin-bottom:10px}
    .welcome-text{font-size:13px;max-width:320px;margin:0 auto;line-height:1.5}

    .card{
      background:var(--card-bg);border:1px solid var(--border);border-radius:16px;overflow:hidden;
      display:flex;flex-direction:column;position:relative;box-shadow:var(--shadow-card);transition:.25s;
      animation:fadeIn .35s ease-out forwards;
    }
    .card.promo-mode{border:2px solid var(--promo-color)!important;box-shadow:0 0 25px var(--promo-glow)!important;transform:scale(1.01)}
    .card-img-container{
      width:100%;aspect-ratio:1/1;background-color:#fff;
      background-size:contain;background-position:center;background-repeat:no-repeat;
      position:relative;overflow:hidden;border-bottom:1px solid var(--border);
    }

    .card.agotado .card-img-container{filter:grayscale(100%);opacity:.75}
    .ribbon{
      position:absolute;top:15px;left:-30px;width:110px;background:var(--danger);color:#fff;
      font-size:10px;font-weight:900;padding:5px 0;transform:rotate(-45deg);text-align:center;
      z-index:10;box-shadow:0 2px 6px rgba(0,0,0,.25);
    }
    .ribbon-promo{
      position:absolute;top:0;right:0;background:linear-gradient(135deg,#f59e0b,#ea580c);
      color:#fff;font-size:10px;font-weight:900;padding:6px 12px;border-bottom-left-radius:12px;
      z-index:10;box-shadow:-2px 2px 10px rgba(245,158,11,.45);letter-spacing:1px;
    }

    .video-badge{
      position:absolute;bottom:8px;right:8px;z-index:20;
      display:flex;align-items:center;gap:5px;
      padding:5px 12px;border-radius:20px;font-size:10px;font-weight:900;color:#fff;text-decoration:none;
      backdrop-filter:blur(4px);box-shadow:0 2px 8px rgba(0,0,0,.3);transition:.18s;letter-spacing:.5px;
      text-transform:uppercase;
    }
    .video-badge:hover{transform:scale(1.05)}
    .video-badge.tiktok{background:rgba(0,0,0,.9);border:1px solid rgba(255,255,255,.2)}
    .video-badge.youtube{background:rgba(220,38,38,.95);border:1px solid rgba(255,255,255,.2)}

    .card-body{padding:16px;display:flex;flex-direction:column;gap:8px;flex-grow:1}
    .card h3{
      margin:0;font-size:16px;font-weight:900;line-height:1.25;text-transform:uppercase;letter-spacing:.4px;
      overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;height:42px;
      color:var(--text);text-shadow:0 1px 2px rgba(0,0,0,.25);
    }
    .desc{
      font-size:13.5px;font-weight:700;color:var(--text);opacity:.92;line-height:1.6;
      white-space:pre-line;padding-left:5px;
    }

    .btn-gallery{
      display:flex;align-items:center;justify-content:center;gap:6px;width:100%;
      padding:8px;margin-top:6px;background:transparent;border:1px dashed var(--border);
      border-radius:10px;color:var(--text-muted);font-size:11px;font-weight:900;text-decoration:none;
      text-transform:uppercase;letter-spacing:.5px;transition:.18s;
    }
    .btn-gallery:hover{background:var(--card-bg);border-color:var(--primary);color:var(--primary)}

    .price-bar{
      display:flex;align-items:center;justify-content:center;gap:8px;background:rgba(255,255,255,.03);
      border:1px solid var(--border);border-radius:10px;padding:10px;margin-top:10px;
    }
    [data-theme="light"] .price-bar{background:#f0fdf4;border-color:#dcfce7}
    .price-stack{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;line-height:1.2}
    .old-price-row{color:var(--text-muted);line-height:1;margin-bottom:3px;white-space:nowrap;display:flex;gap:6px;align-items:center;justify-content:center}
    .p-label-small{font-size:10px;font-weight:900;text-transform:uppercase;letter-spacing:.5px;opacity:.85}
    .old-val{text-decoration:line-through;opacity:.75;font-size:12px}
    .current-price-row{font-size:22px;font-weight:900;color:var(--accent);line-height:1;white-space:nowrap}
    .price-icon{color:var(--accent);font-size:16px;opacity:.85}
    .card.promo-mode .price-bar{background:var(--promo-bg);border-color:var(--promo-color)}
    .card.promo-mode .price-icon,.card.promo-mode .current-price-row{color:var(--promo-color);text-shadow:0 0 10px var(--promo-glow)}
    .card.agotado .price-bar{background:rgba(239,68,68,.12);border-color:var(--danger)}
    .card.agotado .price-icon,.card.agotado .current-price-row{color:var(--danger);text-shadow:none}
    [data-theme="light"] .card.agotado .price-bar{background:#fef2f2;border-color:#fca5a5}

    .btn-ws{
      background:var(--primary);color:#fff;border:none;padding:12px;border-radius:10px;
      font-weight:900;font-size:13px;cursor:pointer;text-decoration:none;
      display:flex;align-items:center;justify-content:center;gap:6px;text-transform:uppercase;transition:.18s;
    }
    [data-theme="dark"] .btn-ws{color:#000}
    .btn-ws:active{transform:scale(.99)}

    /* PROMO BOX */
    .promo-box{
      margin-top:10px;border:1px solid rgba(255,107,0,.35);background:rgba(255,107,0,.08);
      border-radius:14px;padding:12px;display:flex;flex-direction:column;gap:10px;
    }
    [data-theme="light"] .promo-box{background:#fff7ed;border-color:rgba(234,88,12,.25)}
    .promo-top{
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      border:1px solid rgba(255,107,0,.35);border-radius:12px;padding:10px;background:rgba(255,255,255,.06);
    }
    [data-theme="light"] .promo-top{background:#fff}
    .promo-total{
      font-size:28px;font-weight:900;color:var(--promo-color);line-height:1;
      display:flex;align-items:center;gap:8px;
    }
    .promo-sub{font-size:12px;font-weight:900;color:var(--text-muted);text-transform:uppercase;letter-spacing:.6px;margin-top:4px;text-align:center}

    .qty-row{display:flex;gap:10px;align-items:center;justify-content:center}
    .qty-btn{
      width:44px;height:44px;border-radius:12px;border:1px solid var(--border);
      background:rgba(255,255,255,.04);color:var(--text);
      display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:900;cursor:pointer;
      transition:.16s; user-select:none;
    }
    .qty-btn:active{transform:scale(.98)}
    .qty-btn.disabled{opacity:.35;cursor:not-allowed}
    .qty-mid{
      flex:1;text-align:center;border:1px solid var(--border);border-radius:12px;padding:10px 12px;
      font-size:16px;font-weight:900;text-transform:uppercase;letter-spacing:.5px;background:rgba(255,255,255,.05);
    }

    .quick-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:2px}

    .qbtn{
      position:relative;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.14);
      color:var(--text);border-radius:12px;padding:8px 10px;
      font-size:12px;font-weight:900;text-transform:uppercase;letter-spacing:.3px;
      display:flex;align-items:center;justify-content:space-between;gap:8px;
      cursor:pointer;transition:.16s;
      user-select:none;
    }
    [data-theme="light"] .qbtn{background:#fff}
    .qbtn strong{color:var(--promo-color)}
    .qbtn.active{outline:2px solid rgba(255,107,0,.55);box-shadow:0 0 18px rgba(255,107,0,.18)}
    .qbtn.disabled{opacity:.4;cursor:not-allowed}
    .qbtn.disabled::after{
      content:"NO DISPONIBLE";
      position:absolute;inset:0;
      display:flex;align-items:center;justify-content:center;
      font-size:11px;font-weight:900;letter-spacing:.8px;text-transform:uppercase;
      color:#fff;background:rgba(0,0,0,.55);
      border-radius:12px;
      text-shadow:0 1px 2px rgba(0,0,0,.35);
    }

    .stock-note{
      font-size:11px;font-weight:900;color:var(--text-muted);
      text-transform:uppercase;letter-spacing:.5px;text-align:center;margin-top:2px;
    }

    /* ALERTA DENTRO DE LA CARD (PROMO) */
    .promo-alert{
      display:none;
      border:1px solid rgba(239,68,68,.45);
      background:rgba(239,68,68,.12);
      color:#ffd1d1;
      padding:10px 12px;
      border-radius:12px;
      font-size:12px;
      font-weight:900;
      text-transform:uppercase;
      letter-spacing:.5px;
      text-align:center;
      margin-top:2px;
    }
    [data-theme="light"] .promo-alert{
      color:#7f1d1d;
      background:#fef2f2;
      border-color:#fca5a5;
    }
    .promo-alert.show{display:block}

    /* TESTIMONIOS */
    .testimonials-section{
      padding:30px 16px;margin-top:20px;background:rgba(255,255,255,.02);
      border-top:1px solid var(--border);border-bottom:1px solid var(--border);
    }
    .sec-title{text-align:center;font-size:18px;font-weight:900;margin-bottom:16px;color:var(--text);text-transform:uppercase}
    .testimonials-track{display:flex;gap:15px;overflow-x:auto;padding-bottom:10px;scrollbar-width:none}
    .t-card{min-width:260px;max-width:260px;background:var(--card-bg);border:1px solid var(--border);border-radius:12px;padding:15px;display:flex;flex-direction:column;gap:8px}
    .t-header{display:flex;align-items:center;gap:10px;margin-bottom:2px}
    .t-avatar{width:35px;height:35px;border-radius:50%;background:var(--primary);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:14px}
    [data-theme="dark"] .t-avatar{color:#000}
    .t-info h4{margin:0;font-size:13px;color:var(--text);font-weight:900}
    .t-info span{font-size:10px;color:var(--accent);font-weight:900;text-transform:uppercase}
    .t-stars{color:#fbbf24;font-size:12px;margin:0}
    .t-text{font-size:12px;color:var(--text-muted);line-height:1.45;font-style:italic;margin:0;text-align:justify}

    /* UBICACI√ìN */
    .location-section{padding:20px 16px;margin-top:10px;text-align:center}
    .map-holder{
      width:100%;height:250px;border:2px solid var(--border);border-radius:16px;margin-bottom:12px;
      display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;
      background:rgba(255,255,255,.03);
    }
    .map-holder button{
      border:none;cursor:pointer;
      padding:12px 16px;border-radius:12px;font-weight:900;text-transform:uppercase;
      background:var(--primary);color:#000;display:flex;gap:8px;align-items:center;
    }
    [data-theme="light"] .map-holder button{color:#fff}
    .location-btns{display:flex;gap:10px;justify-content:center}
    .btn-loc{flex:1;padding:12px;border-radius:12px;font-weight:900;font-size:12px;text-decoration:none;display:flex;align-items:center;justify-content:center;gap:8px;text-transform:uppercase;transition:.2s}
    .btn-google{background:#4285F4;color:#fff;box-shadow:0 4px 10px rgba(66,133,244,.25)}
    .btn-waze{background:#33ccff;color:#fff;box-shadow:0 4px 10px rgba(51,204,255,.25)}

    .faq-section{padding:20px 16px;max-width:820px;margin:0 auto}
    .faq-item{background:var(--card-bg);border:1px solid var(--border);border-radius:12px;margin-bottom:10px;overflow:hidden}
    .faq-question{padding:15px;font-size:14px;font-weight:900;color:var(--text);display:flex;justify-content:space-between;align-items:center;cursor:pointer}
    .faq-answer{padding:0 15px 15px;font-size:13px;color:var(--text-muted);line-height:1.5;display:none;text-align:justify}
    .faq-item.open .faq-answer{display:block}
    .faq-item.open .faq-question i{transform:rotate(180deg)}

    footer{text-align:center;padding:30px 20px;color:var(--text-muted);font-size:12px;margin-top:20px;border-top:1px solid var(--border)}
    .social-bar{display:flex;justify-content:center;gap:15px;margin-bottom:20px}
    .social-btn{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:20px;color:#fff;text-decoration:none;transition:.3s;box-shadow:0 4px 10px rgba(0,0,0,.3)}
    .sb-insta{background:linear-gradient(45deg,#f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%)}
    .sb-fb{background:#1877F2}
    .sb-tiktok{background:#000;border:1px solid #333}

    .float-ws{
      position:fixed;bottom:20px;right:20px;
      background:#25D366;border-radius:999px;
      display:flex;align-items:center;justify-content:center;
      color:#fff;font-size:18px;font-weight:900;
      gap:10px;padding:14px 16px;box-shadow:0 4px 15px rgba(0,0,0,.25);z-index:200;text-decoration:none;
    }
    .float-ws i{font-size:24px}
    .float-ws span{text-transform:uppercase;letter-spacing:.4px}

    #loader{display:flex;flex-direction:column;align-items:center;justify-content:center;height:260px;color:var(--text)}
    .spinner{width:40px;height:40px;border:4px solid var(--border);border-top-color:var(--primary);border-radius:50%;animation:spin .8s linear infinite;margin-bottom:18px}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    @keyframes spin{to{transform:rotate(360deg)}}

    /* TOAST (se deja para copiar link) */
    #toast{
      position:fixed;left:50%;bottom:90px;transform:translateX(-50%);
      background:rgba(0,0,0,.85);color:#fff;padding:10px 14px;border-radius:999px;
      font-size:12px;font-weight:900;letter-spacing:.4px;text-transform:uppercase;
      z-index:999;opacity:0;pointer-events:none;transition:.2s;
      box-shadow:0 10px 25px rgba(0,0,0,.3);
      max-width:92%;text-align:center;
    }
    #toast.show{opacity:1}
  </style>
</head>
<body>

<header>
  <div class="brand" id="brandHome">
    <img src="logo.png" alt="SDC" onerror="this.style.display='none'">
    <div>
      <h1>Soluciones <span>Digitales</span></h1>
      <small style="color:var(--text-muted); font-size:10px; letter-spacing:1px; font-weight:900;">COMAYAGUA</small>
    </div>
  </div>
  <div class="icon-row">
    <div class="icon-btn" id="copyLinkBtn" title="Copiar link"><i class="fa-solid fa-link"></i></div>
    <div class="icon-btn" id="themeToggle"><i class="fa-solid fa-sun"></i></div>
  </div>
</header>

<div class="hero-section">
  <h2 class="hero-title">üéÆ <span class="hero-highlight">Accesorios Gamer</span> & Tecnolog√≠a</h2>
  <p class="hero-desc">En Comayagua. Atenci√≥n directa por WhatsApp.<br>Productos probados y ofertas reales.</p>
</div>

<div class="search-container">
  <div class="search-box">
    <i class="fa-solid fa-search"></i>
    <input id="searchInput" type="text" placeholder="Buscar producto..." />
  </div>
</div>

<div class="trust-grid">
  <div class="trust-item"><i class="fa-solid fa-truck-fast"></i> Env√≠os a toda HN</div>
  <div class="trust-item"><i class="fa-solid fa-shield-halved"></i> Compra Segura</div>
  <div class="trust-item"><i class="fa-solid fa-headset"></i> Atenci√≥n Real</div>
  <div class="trust-item"><i class="fa-solid fa-star"></i> Clientes Felices</div>
</div>

<div class="filters-wrapper" id="filtersWrapper">
  <div class="category-bar" id="categoryBar">
    <div class="chip">Cargando...</div>
  </div>
  <div class="sub-bar" id="subBar"></div>
</div>

<div class="info-bar" id="infoBar" style="display:none;"></div>

<div id="loader">
  <div class="spinner"></div>
  <p style="font-weight:900; letter-spacing:1px;">CARGANDO DATOS...</p>
</div>

<div class="grid" id="productGrid"></div>

<div class="testimonials-section" id="testimonialsSection" style="display:none;">
  <h3 class="sec-title">‚≠ê Lo que dicen los Gamers</h3>
  <div class="testimonials-track" id="testimonialsTrack"></div>
</div>

<div class="location-section">
  <h3 class="sec-title">üìç Base de Operaciones</h3>
  <div class="map-holder" id="mapHolder">
    <button id="loadMapBtn"><i class="fa-solid fa-map-location-dot"></i> Cargar mapa</button>
  </div>

  <div class="location-btns">
    <a href="https://www.google.com/maps/search/?api=1&query=Inkmortal+Tattoo+Comayagua" target="_blank" class="btn-loc btn-google">
      <i class="fa-solid fa-map-location-dot"></i> Google Maps
    </a>
    <a href="https://waze.com/ul?ll=14.454458,-87.6278246&navigate=yes" target="_blank" class="btn-loc btn-waze">
      <i class="fa-brands fa-waze"></i> Waze
    </a>
  </div>
</div>

<div class="faq-section">
  <h3 class="sec-title" style="margin-top:20px;">‚ùì Preguntas Frecuentes</h3>

  <div class="faq-item">
    <div class="faq-question" onclick="toggleFaq(this)">¬øHacen env√≠os a toda Honduras? <i class="fa-solid fa-chevron-down"></i></div>
    <div class="faq-answer">
      S√≠ üöö hacemos env√≠os a todo Honduras con empresas como <b>C807, Forza y Cargo Expreso</b>.
      <br><br>
      <b>Importante:</b> Si eliges <b>Cobro Contra Entrega</b>, el costo de env√≠o se paga al recibir (lo cobra la empresa de env√≠os).
    </div>
  </div>

  <div class="faq-item">
    <div class="faq-question" onclick="toggleFaq(this)">¬øQu√© m√©todos de pago aceptan? <i class="fa-solid fa-chevron-down"></i></div>
    <div class="faq-answer">
      Aceptamos <b>Efectivo</b> y <b>Transferencia Bancaria</b>. Tambi√©n <b>PayPal</b> y <b>Tigo Money</b>.
    </div>
  </div>

  <div class="faq-item">
    <div class="faq-question" onclick="toggleFaq(this)">¬øC√≥mo puedo comprar? <i class="fa-solid fa-chevron-down"></i></div>
    <div class="faq-answer">
      Elige tu producto, selecciona la cantidad (si aplica) y toca <b>"PEDIR AHORA"</b>. Te llevar√° a WhatsApp con el mensaje listo.
    </div>
  </div>
</div>

<footer>
  <div class="social-bar">
    <a href="https://www.facebook.com/sdcomayagua/" target="_blank" class="social-btn sb-fb"><i class="fa-brands fa-facebook-f"></i></a>
    <a href="https://www.instagram.com/sdcomayagua/" target="_blank" class="social-btn sb-insta"><i class="fa-brands fa-instagram"></i></a>
    <a href="https://www.tiktok.com/@gamer.comayagua" target="_blank" class="social-btn sb-tiktok"><i class="fa-brands fa-tiktok"></i></a>
  </div>
  <p>¬© 2026 Soluciones Digitales Comayagua<br><span style="font-size:10px; opacity:0.6;">Todos los derechos reservados.</span></p>
</footer>

<a class="float-ws" href="https://wa.me/50432429490" target="_blank"><i class="fa-brands fa-whatsapp"></i><span>Cotizar</span></a>

<div id="toast"></div>

<script>
  // ========= CONFIG =========
  const SHEET_ID = "1J-y47gPZuuyQOxaj9OJa4tMzR2IjfQVAzCR1i928dng";
  const CONFIG_GID = "1488858707";
  const MY_PHONE = "50432429490";
  const TESTIMONIOS_SHEET = "testimonios";
  const BACKUP_SHEETS = ["ofertas","gamer","pc","movil","streaming","cobertores","power"];

  // ========= ESTADO =========
  let products = [];
  let testimonials = [];
  let currentCategory = "";
  let currentSub = "";
  let soloOfertas = false;
  const promoState = new Map();   // key -> qty
  const promoAlertTimers = new Map(); // key -> timerId

  // ========= HELPERS =========
  function toast(msg){
    const t = document.getElementById("toast");
    t.textContent = msg;
    t.classList.add("show");
    clearTimeout(window.__toastTimer);
    window.__toastTimer = setTimeout(()=>t.classList.remove("show"), 2200);
  }

  function showPromoAlert(key, msg){
    const el = document.getElementById("promoAlert-"+key);
    if(!el) return;
    el.textContent = msg;
    el.classList.add("show");

    if(promoAlertTimers.has(key)) clearTimeout(promoAlertTimers.get(key));
    const timer = setTimeout(()=> el.classList.remove("show"), 2600);
    promoAlertTimers.set(key, timer);
  }

  function toggleFaq(element){ element.parentElement.classList.toggle("open"); }

  function norm(s){
    return (s||"").toString().trim().toLowerCase()
      .normalize("NFD").replace(/[\u0300-\u036f]/g,"");
  }
  function toNum(v){
    if (v === null || v === undefined) return 0;
    const s = (""+v).replace(/[^\d.]/g,"");
    const n = parseFloat(s);
    return isNaN(n) ? 0 : n;
  }
  function hashKey(str){
    str = (str||"").toString();
    let h = 5381;
    for (let i=0;i<str.length;i++) h = ((h<<5)+h) + str.charCodeAt(i);
    return "k" + (h>>>0).toString(16);
  }
  function getIconForCategory(catName){
    const name = norm(catName);
    if(!name) return "üì¶";
    if(name.includes("gamer")||name.includes("juego")) return "üéÆ";
    if(name.includes("celular")||name.includes("movil")||name.includes("phone")||name.includes("samsung")||name.includes("iphone")) return "üì±";
    if(name.includes("pc")||name.includes("computadora")) return "üñ•Ô∏è";
    if(name.includes("stream")) return "üì∫";
    if(name.includes("audio")) return "üéß";
    if(name.includes("power")) return "üîã";
    if(name.includes("cobert")) return "üì¶";
    return "üì¶";
  }

  // ========= URL =========
  function updateUrl(){
    const url = new URL(window.location);
    if (currentCategory) url.searchParams.set("cat", currentCategory);
    else url.searchParams.delete("cat");
    if (currentSub) url.searchParams.set("sub", currentSub);
    else url.searchParams.delete("sub");
    if (soloOfertas) url.searchParams.set("promo","1");
    else url.searchParams.delete("promo");
    window.history.replaceState({}, "", url);
  }

  function loadFromUrl(){
    const params = new URLSearchParams(window.location.search);
    const cat = params.get("cat") || "";
    const sub = params.get("sub") || "";
    const promo = params.get("promo")==="1";

    soloOfertas = promo;
    currentCategory = cat;
    currentSub = sub;

    setTimeout(()=>{
      const promoChip = document.querySelector('[data-action="togglePromo"]');
      if(promoChip){
        promoChip.classList.toggle("off", !soloOfertas);
        promoChip.classList.toggle("active", soloOfertas);
      }
      const catChips = document.querySelectorAll(".category-bar .chip[data-cat]");
      catChips.forEach(c=>c.classList.toggle("active", c.dataset.cat===currentCategory));
      updateSubs();
      if(currentSub){
        const subChips = document.querySelectorAll(".sub-bar .chip[data-sub]");
        subChips.forEach(s=>s.classList.toggle("active", s.dataset.sub===currentSub));
      }
      render();
    },60);
  }

  // ========= FETCH SHEETS =========
  function fetchConfig(){
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&gid=${CONFIG_GID}`;
    const timeoutPromise = new Promise((_,rej)=>setTimeout(()=>rej(new Error("Timeout")), 3500));
    Promise.race([fetch(url), timeoutPromise])
      .then(r=>r.text())
      .then(t=>{
        const json = JSON.parse(t.substring(47, t.length-2));
        const sheetNames = json.table.rows
          .map(r=>r.c[0]?r.c[0].v:null)
          .filter(n=>n && norm(n)!=="sheet");
        const cleaned = sheetNames
          .map(s=>s.toString().trim())
          .filter(s=>norm(s)!=="testimonios" && !norm(s).includes("config"));
        loadAllTabs(cleaned.length?cleaned:BACKUP_SHEETS);
      })
      .catch(()=>loadAllTabs(BACKUP_SHEETS));
  }

  function fetchTab(sheetName){
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;
    return fetch(url)
      .then(r=>r.text())
      .then(t=>{
        const json = JSON.parse(t.substring(47, t.length-2));
        const cols = json.table.cols.map(c => c && c.label ? norm(c.label) : "col");
        return json.table.rows.map(r=>{
          let obj = {};
          r.c.forEach((c,i)=> obj[cols[i]] = c ? (c.v===null?"":c.v) : "");
          if(!obj.categoria) obj.categoria = sheetName;

          obj.stock = toNum(obj.stock);
          obj.precio = toNum(obj.precio);
          obj.precio_anterior = toNum(obj.precio_anterior);
          if(!obj.descripcion && obj.descipcion) obj.descripcion = obj.descipcion;

          return obj;
        }).filter(p=>p.nombre);
      })
      .catch(()=>[]);
  }

  function fetchTestimonials(){
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(TESTIMONIOS_SHEET)}`;
    return fetch(url)
      .then(r=>r.text())
      .then(t=>{
        const json = JSON.parse(t.substring(47, t.length-2));
        const cols = json.table.cols.map(c=>c && c.label ? norm(c.label) : "col");
        testimonials = json.table.rows.map(r=>{
          let obj = {};
          r.c.forEach((c,i)=> obj[cols[i]] = c ? (c.v===null?"":c.v) : "");
          return obj;
        }).filter(x=>x.nombre && x.texto);
      })
      .catch(()=>{ testimonials = []; });
  }

  function loadAllTabs(sheetNames){
    Promise.all([
      Promise.all(sheetNames.map(n=>fetchTab(n))),
      fetchTestimonials()
    ]).then(([results])=>{
      products = results.flat();
      const loader = document.getElementById("loader");
      if(!products.length){
        loader.innerHTML = "<p style='font-weight:900;color:var(--text-muted)'>No se encontraron productos.</p>";
        return;
      }
      loader.style.display = "none";
      initCategories();
      renderTestimonials();
      loadFromUrl();
    });
  }

  // ========= CATEGOR√çAS =========
  function initCategories(){
    const bar = document.getElementById("categoryBar");
    bar.innerHTML = "";

    const promoBtn = document.createElement("div");
    promoBtn.className = "chip promo-toggle off";
    promoBtn.dataset.action = "togglePromo";
    promoBtn.innerHTML = `üí• SOLO OFERTAS`;
    promoBtn.onclick = ()=>{
      soloOfertas = !soloOfertas;
      promoBtn.classList.toggle("off", !soloOfertas);
      promoBtn.classList.toggle("active", soloOfertas);
      updateUrl();
      updateSubs();
      render();
    };
    bar.appendChild(promoBtn);

    const rawCats = products
      .map(p=>p.categoria ? p.categoria.toString().trim() : "Otros")
      .filter(c=>norm(c)!=="ofertas" && norm(c)!=="testimonios" && !norm(c).includes("config"));
    const cats = [...new Set(rawCats)];

    cats.forEach((c)=>{
      const btn = document.createElement("div");
      btn.className = "chip";
      btn.dataset.cat = c;
      btn.innerHTML = `${getIconForCategory(c)} ${c}`;
      btn.onclick = ()=>{
        currentCategory = c;
        currentSub = "";
        document.querySelectorAll(".category-bar .chip[data-cat]").forEach(b=>b.classList.remove("active"));
        btn.classList.add("active");
        updateUrl();
        updateSubs();
        render();
      };
      bar.appendChild(btn);
    });

    updateSubs();
  }

  function updateSubs(){
    const bar = document.getElementById("subBar");
    bar.innerHTML = "";
    if(!currentCategory){ bar.style.display="none"; return; }

    const main = products.filter(p=>p.categoria && p.categoria.toString().trim()===currentCategory);
    const subs = [...new Set(main.map(p=>p.subcategoria).filter(Boolean))];

    if(!subs.length){ bar.style.display="none"; return; }
    bar.style.display="flex";

    const allBtn = document.createElement("div");
    allBtn.className = "chip";
    allBtn.dataset.sub = "";
    allBtn.textContent = "Todo";
    allBtn.onclick = ()=>{
      currentSub = "";
      document.querySelectorAll(".sub-bar .chip").forEach(b=>b.classList.remove("active"));
      allBtn.classList.add("active");
      updateUrl();
      render();
    };
    bar.appendChild(allBtn);

    subs.forEach(s=>{
      const btn = document.createElement("div");
      btn.className = "chip";
      btn.dataset.sub = s;
      btn.textContent = s;
      btn.onclick = ()=>{
        currentSub = s;
        document.querySelectorAll(".sub-bar .chip").forEach(b=>b.classList.remove("active"));
        btn.classList.add("active");
        updateUrl();
        render();
      };
      bar.appendChild(btn);
    });

    const active = [...bar.querySelectorAll(".chip")].find(x=>x.dataset.sub===currentSub) || allBtn;
    active.classList.add("active");
  }

  // ========= PROMOS POR CANTIDAD =========
  function isQtyPromo(p){
    const isOfertas = norm(p.categoria)==="ofertas";
    if(!isOfertas) return false;
    const n = norm(p.nombre);
    return (n.includes("dedal") || n.includes("enfriador"));
  }

  // Dedales: 1=40, 2+=38, 4+=34, 6+=30, 8+=27, 10+=23, 12+=20 (cap)
  function unitPriceDedales(q){
    if(q>=12) return 20;
    if(q>=10) return 23;
    if(q>=8) return 27;
    if(q>=6) return 30;
    if(q>=4) return 34;
    if(q>=2) return 38;
    return 40;
  }

  // Enfriador: 1=170, 2+=160, 3+=150, 4+=145, 5+=140, 6+=135, 8+=130, 10+=125, 12+=120 (cap)
  function unitPriceEnfriador(q){
    if(q>=12) return 120;
    if(q>=10) return 125;
    if(q>=8) return 130;
    if(q>=6) return 135;
    if(q>=5) return 140;
    if(q>=4) return 145;
    if(q>=3) return 150;
    if(q>=2) return 160;
    return 170;
  }

  function promoPricing(p, q){
    const name = norm(p.nombre);
    const unit = name.includes("dedal") ? unitPriceDedales(q) : unitPriceEnfriador(q);
    return { unit, total: unit*q };
  }

  function getDefaultQty(p){
    const stock = Math.max(0, toNum(p.stock));
    if(stock<=0) return 0;
    return 1;
  }

  function clampQtyToStock(q, stock){
    q = Math.max(1, Math.floor(q||1));
    if(stock>0) q = Math.min(q, stock);
    return q;
  }

  function getQuickChoices(p){
    const name = norm(p.nombre);
    if(name.includes("enfriador")) return [1,2,3,4,5,6,8,9,10,12,16,20,24];
    return [1,2,3,4,6,8,9,10,12,16,18,20,24];
  }

  function buildWaMessage(p, qty, unit, total){
    const name = p.nombre || "Producto";
    const stock = Math.max(0, toNum(p.stock));
    const tipo = norm(p.nombre).includes("dedal") ? "par(es)" : "unidad(es)";
    return `Hola SDC, quiero *${name}*.\n\n‚úÖ Cantidad: ${qty} ${tipo}\nüíµ Precio unitario: Lps. ${unit}\nüßæ Total: Lps. ${total}\nüì¶ Stock disponible: ${stock}\n\nQuedo atento(a). Gracias.`;
  }

  function renderPromoBox(p, key){
    const stock = Math.max(0, toNum(p.stock));
    let qty = promoState.has(key) ? promoState.get(key) : getDefaultQty(p);
    if(stock>0) qty = clampQtyToStock(qty, stock);
    promoState.set(key, qty);

    const {unit, total} = promoPricing(p, qty);

    const tiers = [
      {label:"2+", q:2, u: (norm(p.nombre).includes("dedal")?38:160)},
      {label:"4+", q:4, u: (norm(p.nombre).includes("dedal")?34:145)},
      {label:"6+", q:6, u: (norm(p.nombre).includes("dedal")?30:135)},
      {label:"8+", q:8, u: (norm(p.nombre).includes("dedal")?27:130)},
      {label:"10+", q:10, u: (norm(p.nombre).includes("dedal")?23:125)},
      {label:"12+", q:12, u: (norm(p.nombre).includes("dedal")?20:120)},
    ];

    const tierHtml = tiers.map(t=>{
      const disabled = stock>0 && t.q>stock;
      const active = qty===t.q;
      return `<div class="qbtn ${active?"active":""} ${disabled?"disabled":""}" data-action="setQty" data-key="${key}" data-qty="${t.q}">
        <span>${t.label}</span><strong>Lps.${t.u}</strong>
      </div>`;
    }).join("");

    const quick = getQuickChoices(p).map(n=>{
      const disabled = stock>0 && n>stock;
      const active = qty===n;
      const {unit:u} = promoPricing(p, n);
      return `<div class="qbtn ${active?"active":""} ${disabled?"disabled":""}" data-action="setQty" data-key="${key}" data-qty="${n}">
        <span>${n} ${n===1? "par":"pares"}</span><strong>Lps.${u}</strong>
      </div>`;
    }).join("");

    const maxNote = stock>0 ? `Disponible: ${stock}` : `Disponible: 0`;

    return `
      <div class="promo-box" data-key="${key}">
        <div class="promo-top">
          <div class="promo-total"><i class="fa-solid fa-tag"></i> <span id="promoTotal-${key}">Lps. ${total}</span></div>
          <div class="promo-sub" id="promoSub-${key}">${qty} ${qty===1?"PAR":"PARES"} √ó Lps. <span id="promoUnit-${key}">${unit}</span> c/u</div>
        </div>

        <div class="qty-row">
          <div class="qty-btn ${qty<=1 || stock<=1 ? "disabled":""}" data-action="minus" data-key="${key}">‚àí</div>
          <div class="qty-mid" id="promoQty-${key}">${qty} ${qty===1?"PAR":"PARES"}</div>
          <div class="qty-btn ${stock>0 && qty>=stock ? "disabled":""}" data-action="plus" data-key="${key}">+</div>
        </div>

        <div class="quick-grid">${tierHtml}</div>
        <div class="quick-grid" style="grid-template-columns:repeat(3,1fr)">${quick}</div>

        <div class="stock-note" id="promoStock-${key}">${maxNote} ‚úÖ</div>
        <div class="promo-alert" id="promoAlert-${key}" aria-live="polite"></div>

        <a href="#" target="_blank" class="btn-ws" id="promoWa-${key}" data-action="openWa" data-key="${key}">
          <i class="fa-brands fa-whatsapp"></i> PEDIR ${qty} ${qty===1?"PAR":"PARES"} üöÄ
        </a>
      </div>
    `;
  }

  function updatePromoUIByKey(key){
    const p = products.find(x => hashKey((x.categoria||"")+"|"+(x.nombre||""))===key);
    if(!p) return;

    const stock = Math.max(0, toNum(p.stock));
    let qty = promoState.get(key) || 1;
    qty = clampQtyToStock(qty, stock);
    promoState.set(key, qty);

    const {unit, total} = promoPricing(p, qty);

    const totalEl = document.getElementById("promoTotal-"+key);
    const unitEl  = document.getElementById("promoUnit-"+key);
    const subEl   = document.getElementById("promoSub-"+key);
    const qtyEl   = document.getElementById("promoQty-"+key);
    const waEl    = document.getElementById("promoWa-"+key);
    const stockEl = document.getElementById("promoStock-"+key);

    if(totalEl) totalEl.textContent = `Lps. ${total}`;
    if(unitEl) unitEl.textContent = `${unit}`;
    if(subEl) subEl.innerHTML = `${qty} ${qty===1?"PAR":"PARES"} √ó Lps. <span id="promoUnit-${key}">${unit}</span> c/u`;
    if(qtyEl) qtyEl.textContent = `${qty} ${qty===1?"PAR":"PARES"}`;
    if(stockEl) stockEl.textContent = `Disponible: ${stock} ‚úÖ`;

    if(waEl){
      waEl.innerHTML = `<i class="fa-brands fa-whatsapp"></i> PEDIR ${qty} ${qty===1?"PAR":"PARES"} üöÄ`;
      const msg = buildWaMessage(p, qty, unit, total);
      waEl.href = `https://wa.me/${MY_PHONE}?text=${encodeURIComponent(msg)}`;
      waEl.style.pointerEvents = (stock<=0) ? "none" : "auto";
      waEl.style.opacity = (stock<=0) ? ".5" : "1";
    }

    const box = document.querySelector(`.promo-box[data-key="${key}"]`);
    if(box){
      const minus = box.querySelector(`[data-action="minus"][data-key="${key}"]`);
      const plus  = box.querySelector(`[data-action="plus"][data-key="${key}"]`);
      if(minus) minus.classList.toggle("disabled", qty<=1 || stock<=1);
      if(plus)  plus.classList.toggle("disabled", stock>0 && qty>=stock);

      box.querySelectorAll(`.qbtn[data-action="setQty"][data-key="${key}"]`).forEach(btn=>{
        const q = parseInt(btn.dataset.qty||"0",10);
        btn.classList.toggle("active", q===qty);
        btn.classList.toggle("disabled", stock>0 && q>stock);
      });
    }
  }

  // ========= TESTIMONIOS =========
  function renderTestimonials(){
    const sec = document.getElementById("testimonialsSection");
    const track = document.getElementById("testimonialsTrack");
    if(!testimonials || testimonials.length===0){ sec.style.display="none"; return; }

    const list = testimonials.slice(0,8);
    track.innerHTML = "";

    list.forEach(t=>{
      const nombre = t.nombre || "Cliente";
      const rol = t.rol || "Cliente";
      const texto = t.texto || "";
      const estrellas = Math.max(1, Math.min(5, parseInt(t.estrellas||"5",10)));
      const initials = nombre.split(" ").slice(0,2).map(x=>x[0]).join("").toUpperCase();
      const starsHtml = Array.from({length:5}).map((_,i)=>`<i class="fa-solid fa-star" style="opacity:${i<estrellas?1:.25}"></i>`).join("");

      const card = document.createElement("div");
      card.className="t-card";
      card.innerHTML = `
        <div class="t-header">
          <div class="t-avatar">${initials}</div>
          <div class="t-info"><h4>${nombre}</h4><span>${rol}</span></div>
        </div>
        <div class="t-stars">${starsHtml}</div>
        <p class="t-text">"${texto}"</p>
      `;
      track.appendChild(card);
    });
    sec.style.display="block";
  }

  // ========= RENDER =========
  function render(){
    const grid = document.getElementById("productGrid");
    const info = document.getElementById("infoBar");
    grid.innerHTML = "";
    info.innerHTML = "";
    info.style.display = "none";

    if(!currentCategory && !soloOfertas){
      grid.innerHTML = `
        <div class="welcome-state">
          <div class="welcome-icon"><i class="fa-solid fa-hand-pointer"></i></div>
          <h3 class="welcome-title">¬°Empieza tu b√∫squeda!</h3>
          <p class="welcome-text">Selecciona una categor√≠a arriba (Gamer, PC, M√≥vil...) para ver el cat√°logo.</p>
        </div>
      `;
      return;
    }

    const q = norm(document.getElementById("searchInput").value);

    const main = currentCategory
      ? products.filter(p => (p.categoria||"").toString().trim()===currentCategory)
      : [];

    const offers = products.filter(p => norm(p.categoria)==="ofertas");

    let filtered = [];

    if(soloOfertas){
      if(!currentCategory){
        filtered = offers.slice();
      }else{
        const mainSub = main.filter(p => !currentSub || (p.subcategoria===currentSub));
        const namesMain = new Set(mainSub.map(p => norm(p.nombre)));
        const offersSub = offers.filter(p => (!currentSub || p.subcategoria===currentSub));
        const offersMatch = offersSub.filter(p => namesMain.has(norm(p.nombre)) || offersSub.length===1);

        const namesOffers = new Set(offersMatch.map(p=>norm(p.nombre)));
        const mainMatch = mainSub.filter(p => namesOffers.has(norm(p.nombre)));

        filtered = [...offersMatch, ...mainMatch];
      }
    }else{
      filtered = main.filter(p => !currentSub || p.subcategoria===currentSub);
    }

    if(q){
      filtered = filtered.filter(p => norm(p.nombre).includes(q) || norm(p.descripcion).includes(q));
    }

    info.style.display = "flex";
    const showCat = currentCategory ? currentCategory : "Ofertas";
    info.innerHTML = `
      <div class="info-pill">Mostrando: ${filtered.length}</div>
      <div class="info-pill">Categor√≠a: ${showCat}</div>
      ${soloOfertas ? `<div class="info-pill">Solo Ofertas ‚úÖ</div>` : ``}
    `;

    if(filtered.length===0){
      grid.innerHTML = `<div style="grid-column:1/-1;text-align:center;padding:40px;color:var(--text-muted)">
        <i class="fa-solid fa-ghost" style="font-size:40px;margin-bottom:10px;"></i>
        <p style="font-weight:900;letter-spacing:1px">NO HAY RESULTADOS</p>
      </div>`;
      return;
    }

    filtered.forEach(p=>{
      const stock = Math.max(0, toNum(p.stock));
      const isAgotado = stock<=0;

      let imgUrl = p.imagen || "";
      if(imgUrl && imgUrl.includes("github.com") && imgUrl.includes("/blob/")){
        imgUrl = imgUrl.replace("github.com","raw.githubusercontent.com").replace("/blob/","/");
      }

      let rawDesc = (p.descripcion || "").toString();
      let descText = rawDesc.replace(/(\r\n|\n|\r)/gm," ").replace(/([‚ñ∫‚Ä¢\-‚òÖ])/g, "\n$1").trim();

      let videoBadge = "";
      if(p.tiktok) videoBadge = `<a href="${p.tiktok}" target="_blank" class="video-badge tiktok"><i class="fa-brands fa-tiktok"></i> VER VIDEO</a>`;
      else if(p.youtube) videoBadge_toggle = `<a href="${p.youtube}" target="_blank" class="video-badge youtube"><i class="fa-brands fa-youtube"></i> VER VIDEO</a>`;

      // fix variable name
      if(p.youtube) videoBadge = `<a href="${p.youtube}" target="_blank" class="video-badge youtube"><i class="fa-brands fa-youtube"></i> VER VIDEO</a>`;

      let galleryBtn = p.galeria ? `<a href="${p.galeria}" target="_blank" class="btn-gallery"><i class="fa-regular fa-images"></i> Ver M√°s Fotos</a>` : "";

      let waMsg = (p.whatsapp && (p.whatsapp+"").length>5) ? p.whatsapp : `Hola SDC, me interesa: *${p.nombre}*`;
      if(isAgotado) waMsg = `Hola SDC, el producto *${p.nombre}* est√° AGOTADO. Av√≠senme cuando llegue.`;
      let waLink = `https://wa.me/${MY_PHONE}?text=${encodeURIComponent(waMsg)}`;

      let ribbonHTML = "";
      if(isAgotado) ribbonHTML = `<div class="ribbon">AGOTADO</div>`;
      else if(norm(p.categoria)==="ofertas") ribbonHTML = `<div class="ribbon-promo">üî• HOT SALE</div>`;

      let priceHTMLContent = "";
      if(p.precio_anterior && p.precio_anterior>0){
        priceHTMLContent = `
          <div class="price-stack">
            <div class="old-price-row"><span class="p-label-small">Antes:</span><span class="old-val">Lps. ${p.precio_anterior}</span></div>
            <div class="current-price-row">Lps. ${p.precio || 0}</div>
          </div>`;
      }else{
        priceHTMLContent = `<div class="price-stack"><div class="current-price-row">Lps. ${p.precio || 0}</div></div>`;
      }
      const priceHTML = `<div class="price-bar"><i class="fa-solid fa-tag price-icon"></i>${priceHTMLContent}</div>`;

      const card = document.createElement("div");
      const promoMode = (norm(p.categoria)==="ofertas" && !isAgotado);
      card.className = `card ${isAgotado?"agotado":""} ${promoMode?"promo-mode":""}`;

      const key = hashKey((p.categoria||"")+"|"+(p.nombre||""));

      let promoBoxHtml = "";
      if(isQtyPromo(p)){
        promoBoxHtml = renderPromoBox(p, key);
        waLink = "#";
      }

      card.innerHTML = `
        <div class="card-img-container" style="background-image:url('${imgUrl}');">
          ${ribbonHTML}
          ${videoBadge}
        </div>
        <div class="card-body">
          <h3>${p.nombre}</h3>
          <div class="desc">${descText}</div>

          ${galleryBtn}

          ${isQtyPromo(p) ? promoBoxHtml : priceHTML}

          ${isQtyPromo(p) ? "" : `<a href="${waLink}" target="_blank" class="btn-ws" style="${isAgotado?'background:#333;color:#aaa;box-shadow:none;pointer-events:auto':''}">
            <i class="fa-brands fa-whatsapp"></i> ${isAgotado ? "CONSULTAR" : "PEDIR AHORA üöÄ"}
          </a>`}
        </div>
      `;
      grid.appendChild(card);

      if(isQtyPromo(p) && !isAgotado){
        updatePromoUIByKey(key);
      }
    });
  }

  // ========= EVENTOS PROMO =========
  document.getElementById("productGrid").addEventListener("click", (e)=>{
    const btn = e.target.closest("[data-action]");
    if(!btn) return;

    const action = btn.dataset.action;
    const key = btn.dataset.key;
    if(!key) return;

    const p = products.find(x => hashKey((x.categoria||"")+"|"+(x.nombre||""))===key);
    if(!p) return;

    const stock = Math.max(0, toNum(p.stock));
    let qty = promoState.get(key) || 1;

    if(stock<=0){
      showPromoAlert(key, "AGOTADO");
      return;
    }

    if(action==="plus"){
      if(qty>=stock){
        showPromoAlert(key, `Solo hay ${stock} disponibles`);
        promoState.set(key, stock);
        updatePromoUIByKey(key);
        return;
      }
      qty += 1;
      promoState.set(key, qty);
      updatePromoUIByKey(key);
      return;
    }

    if(action==="minus"){
      qty = Math.max(1, qty-1);
      promoState.set(key, qty);
      updatePromoUIByKey(key);
      return;
    }

    if(action==="setQty"){
      const targetQty = parseInt(btn.dataset.qty||"1",10);
      if(targetQty>stock){
        promoState.set(key, stock);
        updatePromoUIByKey(key);
        showPromoAlert(key, `Solo hay ${stock} disponibles`);
        return;
      }
      promoState.set(key, targetQty);
      updatePromoUIByKey(key);
      return;
    }

    if(action==="openWa"){
      return;
    }
  });

  // ========= SEARCH =========
  let searchTimer = null;
  document.getElementById("searchInput").addEventListener("input", ()=>{
    clearTimeout(searchTimer);
    searchTimer = setTimeout(render, 80);
  });

  // ========= UI =========
  window.addEventListener("scroll", ()=>{
    const f = document.getElementById("filtersWrapper");
    window.scrollY > 50 ? f.classList.add("scrolled") : f.classList.remove("scrolled");
  });

  const toggle = document.getElementById("themeToggle");
  let dark = false;
  document.documentElement.setAttribute("data-theme","light");
  toggle.onclick = ()=>{
    dark = !dark;
    document.documentElement.setAttribute("data-theme", dark?"dark":"light");
    toggle.innerHTML = dark ? '<i class="fa-solid fa-moon"></i>' : '<i class="fa-solid fa-sun"></i>';
  };

  document.getElementById("brandHome").onclick = ()=>{
    currentCategory = "";
    currentSub = "";
    soloOfertas = false;

    document.querySelectorAll(".category-bar .chip[data-cat]").forEach(b=>b.classList.remove("active"));
    document.querySelectorAll(".sub-bar .chip").forEach(b=>b.classList.remove("active"));
    const promoChip = document.querySelector('[data-action="togglePromo"]');
    if(promoChip){
      promoChip.classList.add("off");
      promoChip.classList.remove("active");
    }

    updateUrl();
    updateSubs();
    render();
    window.scrollTo({top:0, behavior:"smooth"});
  };

  document.getElementById("copyLinkBtn").onclick = async ()=>{
    try{
      await navigator.clipboard.writeText(window.location.href);
      toast("Link copiado ‚úÖ");
    }catch{
      toast("No se pudo copiar");
    }
  };

  document.getElementById("loadMapBtn").onclick = ()=>{
    const holder = document.getElementById("mapHolder");
    holder.innerHTML = `
      <iframe class="map-frame" style="width:100%;height:100%;border:0"
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1933.2843779837946!2d-87.6289189153322!3d14.454458000000002!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8f6585356521890d%3A0x5e9e0d326671793d!2sInkmortal%20Tattoo%20Comayagua!5e0!3m2!1ses!2shn!4v1709660000000!5m2!1ses!2shn"
        loading="lazy" referrerpolicy="no-referrer-when-downgrade" allowfullscreen></iframe>
    `;
  };

  // ========= INIT =========
  fetchConfig();
</script>
</body>
</html>